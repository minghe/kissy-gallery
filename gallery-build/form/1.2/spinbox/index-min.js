KISSY.add("gallery/form/1.2/spinbox/index",function(h,k,l){function i(b,a){a=h.merge({target:e(b)},a);i.superclass.constructor.call(this,a)}var e=k.all,j=h.DOM;h.extend(i,l,{render:function(){if(!this.get("target").length||this._isNativeSpinBox())return false;this._addHTML();this._eventOnChangeNum();this._eventOnValide()},_isNativeSpinBox:function(){return this.get("target").attr("type")=="number"?true:false},_addHTML:function(){var b=this.get("target"),a=this.get("cls"),c=this.get("ariaLabel");b.each(function(d){var f=
d.parent(),g=e(j.create('<span class="'+a.container+'">')),m=e(j.create('<a href="#!/plus" class="'+a.plus+" "+a.sign+'">+</a>')),n=e(j.create('<a href="#!/minus" class="'+a.minus+" "+a.sign+'">-</a>'));d.attr({"aria-label":c});g.append(n).append(d).append(m);f.append(g)})},_eventOnChangeNum:function(){var b=this,a=b.get("cls");e("."+a.sign).on("click",function(c){var d=e(this).parent().children("."+a.init),f=Number(d.val().trim()),g=Number(d.attr("data-range").trim())||1;if(c.target.className.indexOf(a.plus)>
-1)f+=g;else if(c.target.className.indexOf(a.minus)>-1)f-=g;b._limitRange(f,d)})},_eventOnValide:function(){var b=this,a=b.get("target");a.on("blur",function(){b._formatNum(e(this));b._limitRange(Number(a.val().trim()),e(this))})},_toFloat:function(b){return parseFloat(b)},_formatNum:function(b){var a=Number(b.attr("data-min"))||1,c=this._toFloat(b.val().replace(/[^\d\.]/g,""));c=isNaN(c)?a:Math.max(c,a);b.val(c.toFixed(2))},_limitRange:function(b,a){var c=this._toFloat,d=c(a.attr("data-min"))||1;
c=c(a.attr("data-max"))||1;d=d&&Math.max(d,b);d=c&&Math.min(c,d);a.val(d.toFixed(2))}},{ATTRS:{target:{value:"",setter:function(b){return e(b)},getter:function(b){return e(b)}},cls:{value:{init:"ks-spinbox",sign:"ks-spinbox-sign",plus:"ks-spinbox-plus",minus:"ks-spinbox-minus",container:"ks-plus-minus-operation"}},ariaLabel:{value:"出价框，请输入价格"}}});return i},{requires:["node","base","./index.css"]});
